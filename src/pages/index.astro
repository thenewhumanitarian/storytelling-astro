---
import Layout from '../layouts/Layout.astro'
import StoryGrid from '../components/StoryGrid.astro'
import stories from '../data/stories.json'

function shuffleArray(array) {
	for (let i = array.length - 1; i > 0; i--) {
		// Generate a random index
		const j = Math.floor(Math.random() * (i + 1))

		// Swap elements at indices i and j
		;[array[i], array[j]] = [array[j], array[i]]
	}
}
// Todo: Can this be done "once" per session perhaps?
shuffleArray(stories)
let isAuth = false
---

<script define:vars={{ isAuth }}>
isAuth = true
</script>

{
	isAuth ? (
		<Layout dark title='The Yemen Listening Project' header={true} footer={false} button='filter'>
			<StoryGrid stories={stories} />
		</Layout>
	) : (
		<Layout dark title='The Yemen Listening Project' header={false} footer={false} button='filter'>
			<div class='flex h-screen h-screen-ios w-full absolute justify-center items-center text-white flex-col'>
				<h1 class='text-xl sm:text-4xl'>The Yemen Listening Project</h1>
				<p class='mt-1 px-2 py-1 bg-white text-black font-bold text-base'>Coming soon...</p>
				<p class='text-sm'>
					A project by{' '}
					<a href='https://www.thenewhumanitarian.org/' class='text-white font-bold underline hover:text-burgundy transition-colors'>
						{' '}
						The New Humanitarian
					</a>
				</p>
			</div>
		</Layout>
	)
}

<style>
	body {
		background: black;
	}
	#filter-button {
		z-index: 9999;
	}
</style>
